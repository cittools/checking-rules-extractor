<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
The value of an expression shall be the same under any order of evaluation that the standard permits
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
The value of an expression shall be the same under any order of evaluation that the standard permits [MISRA2004-12_2_a-3]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

"Apart from a few operators (notably the function call operator (), &amp;&amp;, ||, ?: 
and , (comma)) the order in which sub-expressions are evaluated is unspecified 
and can vary. This means that no reliance can be placed on the order of 
evaluation of sub-expressions, and in particular no reliance can be placed on 
the order in which side effects occur. Those points in the evaluation of an 
expression at which all previous side effects can be guaranteed to have taken 
place are called "sequence points". Sequence points and side effects are 
described in sections 5.1.2.3, 6.3 and 6.6 of ISO 9899:1990 [2].
Note that the order of evaluation problem is not solved by the use of 
parentheses, as this is not a precedence issue.
The following notes give some guidance on how dependence on order of evaluation 
may occur, and therefore may assist in adopting the rule."
"This will give different results depending on whether b[i] is evaluated before 
i++ or vice versa. The problem could be avoided by putting the increment 
operation in a separate statement."
See also: MISRA2004-12_4_a, MISRA2004-12_4_b



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

Rule prevents evaluation of expression dependent on compiler version.



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

void foo( ) 
{
    int a, b[10];
    a = b[a] + a++; // Violation
}



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

void foo( )
{
    int a, b[10];
    a = b[a] + a;  // OK
    a++;           // OK
}



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. MISRA-C:2004 Guidelines for the use of the C language in critical systems
    Chapter 6, Section 12

2. Origin: Misra Guidelines - Rule 46

3. JOINT STRIKE FIGHTER, AIR VEHICLE, C++ CODING STANDARDS
   Chapter 4.25 Expressions, AV Rule 204

4. MISRA C++:2008 - Guidelines for the use of the C++ language in critical
   systems, Chapter 6, Section 5, Rule 5-0-1

</PRE>
</BODY>
</HTML>
