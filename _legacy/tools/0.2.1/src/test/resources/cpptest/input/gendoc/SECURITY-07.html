<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Don't use unsafe C functions that do write to range-unchecked buffers
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Don't use unsafe C functions that do write to range-unchecked buffers [SECURITY-07-3]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

Don't use the unsafe C legacy: strcpy, strcat, sprintf, vsprintf, gets, 
strncpy, strncat, snprintf, fgets - functions that do write to range-unchecked 
buffers, and/or do not check and correctly handle out-of-bounds errors.
See also: SECURITY-12,SECURITY-13,SECURITY-16



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

Rule prevents using functions which may cause overflow.



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

#include &lt;string.h&gt;

void foo( void ) {
    char* str1 = "testcase";
    char* str2 = "testcase";
    char* str3 = 0;
    str3 = strcat( str1, str2 );    // Violation
}



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

Don't use the unsafe C legacy.



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

Herb Sutter, Andrei Alexandrescu, "C++ Coding Standards," Addison-Wesley, 
(C) 2005 Pearson Education, Inc.
Chapter: "Type Safety", Rule 99

</PRE>
</BODY>
</HTML>
